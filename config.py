#!/usr/bin/env python3
from pathlib import Path
import re


re_source = re.compile(r'.*\.(c|cc|cpp|cxx|h|hh|hpp|hxx|asm|S)$', re.I)


class Library:
    def __init__(self, name, sparse_files=[]):
        self.name = name
        self.sparse_files = sparse_files

    @property
    def path(self):
        return Path("libraries") / self.name

    @property
    def sparse_paths(self):
        for f in self.sparse_files:
            for p in self.path.glob(f):
                if re_source.match(p.name) and p.is_file():
                    yield p.relative_to(self.path)

"""
Library configuration.

sparse_files should be configured so that there are little to no false
positives. Select files that are a) unique to the library, b) have a long
history and many commits to improve version identification. `metric.py` can
select a useful set of files for you.

In the long run we could scrap the sparse mode, as soon as full mode has better
filters and fewer false positives,
"""
libraries = [
    Library('aom', [
        "av1/encoder/rdopt.c",
        "av1/encoder/encoder.c",
        "av1/encoder/partition_search.c",
        "av1/encoder/encodeframe.c",
        "av1/decoder/decodeframe.c",
        "av1/encoder/bitstream.c",
        "av1/encoder/encoder.h",
        "av1/common/blockd.h",
        "av1/decoder/decodemv.c",
        ]),
    Library('boringssl', [
        "ssl/internal.h",
        "ssl/ssl_lib.cc",
        "ssl/handshake_client.cc",
        "ssl/extensions.cc",
        "ssl/handshake_server.cc",
        "ssl/ssl_test.cc",
        "ssl/tls13_server.cc",
        "ssl/ssl_x509.cc",
        "ssl/s3_lib.cc",
        "ssl/handshake.cc",
        "ssl/tls13_client.cc",
        "ssl/ssl_session.cc",
        "ssl/s3_both.cc",
        "ssl/ssl_cipher.cc",
        "ssl/ssl_cert.cc",
        "ssl/s3_pkt.cc",
        "ssl/d1_both.cc",
        "ssl/tls13_both.cc",
        "crypto/internal.h",
        "crypto/x509/x509_vfy.c",
        "crypto/fipsmodule/ec/ec.c",
        "crypto/fipsmodule/rsa/rsa_impl.c",
        "ssl/t1_enc.cc",
        ]),
    Library('botan', [
        "src/lib/tls/tls12/tls_server_impl_12.cpp",
        "src/lib/tls/tls_server.cpp",
        "src/lib/tls/tls12/tls_client_impl_12.cpp",
        "src/lib/tls/tls_client.cpp",
        "src/lib/tls/tls_messages.h",
        "src/lib/tls/tls12/tls_channel_impl_12.cpp",
        "src/cli/speed.cpp",
        "src/lib/tls/msg_client_hello.cpp",
        "src/tests/unit_x509.cpp",
        "src/tests/test_pubkey.cpp",
        "src/lib/tls/tls_policy.cpp",
        "src/lib/pubkey/ec_group/ec_point.cpp",
        "src/tests/unit_tls.cpp",
        "src/lib/math/bigint/bigint.h",
        "src/lib/x509/x509path.cpp",
        "src/lib/pubkey/rsa/rsa.cpp",
        "src/cli/tls_client.cpp",
        "src/tests/tests.cpp",
        "src/lib/x509/x509cert.cpp",
        "src/lib/x509/x509_ext.cpp",
        "src/tests/test_ffi.cpp",
        "src/lib/tls/tls_policy.h",
        "src/tests/tests.h",
        "src/lib/tls/tls12/msg_client_kex.cpp",
        "src/lib/block/aes/aes.cpp",
        "src/lib/ffi/ffi.h",
        "src/lib/pubkey/pubkey.cpp",
        "src/lib/math/bigint/bigint.cpp",
        "src/lib/tls/tls_extensions.cpp",
        "src/lib/tls/tls12/msg_server_kex.cpp",
        "src/lib/tls/tls12/tls_record.h",
        "src/lib/x509/x509_ca.cpp",
    ]),
    Library('brotli', [
        "c/**/*",
        ]),
    Library('curl', [
        "lib/url.c",
        "lib/urldata.h",
        "lib/http.c",
        "lib/ftp.c",
        "lib/vtls/openssl.c",
        "lib/transfer.c",
        "include/curl/curl.h",
        "lib/multi.c",
        "lib/connect.c",
        "lib/http2.c",
        "src/tool_operate.c",
        "lib/vssh/libssh2.c",
        "lib/easy.c",
        "lib/curl_setup.h",
        "lib/hostip.c",
        "lib/imap.c",
        "lib/smtp.c",
        "lib/sendf.c",
        "lib/vtls/gtls.c",
        "src/tool_getparam.c",
        "lib/vtls/vtls.c",
        "lib/cookie.c",
        "lib/vtls/schannel.c",
        "lib/pop3.c",
        "tests/server/sws.c",
        "lib/telnet.c",
        "lib/formdata.c",
        "lib/ldap.c",
        "lib/file.c",
        "lib/tftp.c",
        "lib/vtls/sectransp.c",
        "include/curl/curlver.h",
        "lib/vquic/curl_ngtcp2.c",
        "tests/server/rtspd.c",
        "lib/version.c",
        ]),
    Library('fatfs', [
        "source/*",
        ]),
    Library('flac', [
        "src/flac/*",
        "src/libFLAC/*",
        "src/libFLAC++/*",
        "src/metaflac/*",
        "utils/**/*",
        ]),
    Library('fmt', [
        "src/*",
        ]),
    Library('freetype', [
        "src/base/ftobjs.c",
        "include/freetype/freetype.h",
        "src/truetype/ttgload.c",
        "src/truetype/ttinterp.c",
        "src/smooth/ftgrays.c",
        "src/type1/t1load.c",
        "src/sfnt/sfobjs.c",
        "src/cff/cffobjs.c",
        "src/autofit/aflatin.c",
        "src/cff/cffgload.c",
        "src/truetype/ttgxvar.c",
        "src/psaux/cffdecode.c",
        "src/cff/cffload.c",
        "src/psaux/psobjs.c",
        "include/freetype/config/ftoption.h",
        "src/truetype/ttobjs.c",
        "include/freetype/internal/ftobjs.h",
        "src/raster/ftraster.c",
        "src/sfnt/ttload.c",
        "src/cff/cffdrivr.c",
        "devel/ftoption.h",
        "src/psaux/t1decode.c",
        "src/type1/t1objs.c",
        "src/sfnt/sfdriver.c",
        "src/truetype/ttdriver.c",
        "src/sfnt/ttcmap.c",
        "include/freetype/internal/tttypes.h",
        "src/type1/t1gload.c",
        "src/cff/cffparse.c",
        "src/winfonts/winfnt.c",
        "src/base/ftcalc.c",
        ]),
    Library('googletest', [
        "googletest/src/gtest.cc",
        "googletest/include/gtest/internal/gtest-port.h",
        "googletest/test/gtest_unittest.cc",
        "googlemock/include/gmock/gmock-matchers.h",
        "googletest/include/gtest/gtest.h",
        "googletest/include/gtest/internal/gtest-internal.h",
        "googletest/src/gtest-internal-inl.h",
        "googletest/src/gtest-death-test.cc",
        "googlemock/include/gmock/gmock-actions.h",
        "googletest/src/gtest-port.cc",
        "googlemock/test/gmock-actions_test.cc",
        "googlemock/include/gmock/gmock-spec-builders.h",
        "googletest/include/gtest/gtest-printers.h",
        "googletest/test/googletest-printers-test.cc",
        "googlemock/include/gmock/internal/gmock-internal-utils.h",
        "googlemock/src/gmock-spec-builders.cc",
        "googletest/test/googletest-port-test.cc",
        "googletest/test/googletest-death-test-test.cc",
        "googlemock/include/gmock/gmock-more-actions.h",
        "googlemock/test/gmock-spec-builders_test.cc",
        "googletest/test/googletest-output-test_.cc",
        "googletest/include/gtest/internal/gtest-param-util.h",
        "googlemock/test/gmock-internal-utils_test.cc",
        "googletest/include/gtest/gtest-param-test.h",
        "googletest/test/googletest-param-test-test.cc",
        "googletest/src/gtest-filepath.cc",
        "googletest/include/gtest/internal/gtest-death-test-internal.h",
        "googlemock/test/gmock-function-mocker_test.cc",
        "googlemock/include/gmock/internal/gmock-port.h",
        "googletest/src/gtest-printers.cc",
        "googletest/include/gtest/internal/gtest-string.h",
        "googlemock/src/gmock-internal-utils.cc",
        "googletest/include/gtest/gtest-death-test.h",
        "googlemock/test/gmock-more-actions_test.cc",
        "googletest/test/googletest-filepath-test.cc",
        "googletest/include/gtest/internal/gtest-type-util.h",
        "googlemock/test/gmock-nice-strict_test.cc",
        "googletest/include/gtest/gtest-typed-test.h",
        "googletest/include/gtest/gtest-message.h",
        "googletest/include/gtest/internal/gtest-filepath.h",
        "googlemock/include/gmock/gmock-more-matchers.h",
        "googletest/test/gtest-typed-test_test.cc",
        "googlemock/include/gmock/gmock.h",
        "googletest/test/googletest-options-test.cc",
        "googlemock/include/gmock/gmock-nice-strict.h",
        "googletest/test/gtest_repeat_test.cc",
        "googletest/include/gtest/gtest-test-part.h",
        "googlemock/test/gmock_link_test.h",
        "googlemock/test/gmock_output_test_.cc",
        "googletest/include/gtest/gtest-spi.h",
        ]),
    Library('harfbuzz', [
        "src/hb-open-type.hh",
        "src/hb-ot-layout-gsubgpos.hh",
        "src/hb-ot-layout.cc",
        "src/hb-ot-layout-common.hh",
        "src/hb.hh",
        "src/hb-ot-layout-gsub-table.hh",
        "src/hb-ot-layout-gpos-table.hh",
        "src/hb-ot-shape.cc",
        "src/hb-ot-shaper-khmer.cc",
        "src/hb-ot-shaper-indic.cc",
        "src/hb-buffer.cc",
        "src/hb-bit-set.hh",
        "src/hb-subset-plan.cc",
        "src/hb-set.hh",
        "src/hb-font.cc",
        "src/hb-buffer.hh",
        "src/hb-ot-layout.hh",
        "src/OT/Layout/GDEF/GDEF.hh",
        "src/hb-subset.cc",
        "src/hb-ot-layout-gdef-table.hh",
        "src/hb-ft.cc",
        "src/OT/glyf/glyf.hh",
        "src/hb-ot-cmap-table.hh",
        "src/hb-ot-glyf-table.hh",
        "src/hb-common.cc",
        "src/hb-ot-font.cc",
        "src/hb-buffer.h",
        ]),
    Library('hunspell', [
        "src/hunspell/affixmgr.cxx",
        "src/hunspell/hunspell.cxx",
        "src/hunspell/suggestmgr.cxx",
        "src/tools/hunspell.cxx",
        "src/hunspell/csutil.cxx",
        "src/hunspell/hashmgr.cxx",
        "src/hunspell/affixmgr.hxx",
        "src/hunspell/csutil.hxx",
        "src/hunspell/hunspell.hxx",
        "src/hunspell/suggestmgr.hxx",
        "src/hunspell/affentry.cxx",
        "src/hunspell/hashmgr.hxx",
        "src/hunspell/affentry.hxx",
        "src/hunspell/replist.cxx",
        "src/parsers/textparser.cxx",
        "src/tools/munch.cxx",
        "src/tools/unmunch.cxx",
        "src/parsers/textparser.hxx",
        "src/hunspell/atypes.hxx",
        "src/parsers/xmlparser.cxx",
        "src/parsers/latexparser.cxx",
        "src/hunspell/replist.hxx",
        "src/tools/hzip.cxx",
        ]),
    Library('json-c', [
        "*",
        ]),
    Library('leveldb', [
        "db/db_test.cc",
        "db/db_impl.cc",
        "db/version_set.cc",
        "benchmarks/db_bench.cc",
        "util/env_posix.cc",
        "include/leveldb/db.h",
        "port/port_stdcxx.h",
        "util/env_test.cc",
        "db/db_impl.h",
        "table/table_test.cc",
        "include/leveldb/options.h",
        "include/leveldb/env.h",
        "db/version_set.h",
        "util/cache.cc",
        "db/corruption_test.cc",
        "db/repair.cc",
        "db/log_test.cc",
        "db/dbformat.h",
        "db/log_reader.cc",
        "port/port_example.h",
        "db/skiplist_test.cc",
        "db/db_iter.cc",
        ]),
    Library('libb2', [
        "src/blake2b.c",
        "src/blake2s.c",
        "src/blake2-impl.h",
        "src/blake2-dispatch.c",
        "src/blake2bp.c",
        "src/blake2.h",
        "src/blake2b-ref.c",
        "src/blake2s-ref.c",
        "src/blake2sp.c",
        "src/blake2-config.h",
        "src/blake2b-round.h",
        "src/blake2s-load-xop.h",
        "src/blake2s-round.h",
        ]),
    Library('libbpf', [
        "src/libbpf.c",
        "src/libbpf.h",
        "src/btf.c",
        "src/bpf.c",
        "src/libbpf_internal.h",
        "src/bpf.h",
        "src/bpf_helper_defs.h",
        "src/btf.h",
        "src/btf_dump.c",
        "src/bpf_tracing.h",
        "src/bpf_helpers.h",
        "src/libbpf_probes.c",
        "src/netlink.c",
        "src/linker.c",
        "src/usdt.c",
        "src/bpf_core_read.h",
        "src/ringbuf.c",
        "src/gen_loader.c",
        "src/relo_core.c",
        "src/elf.c",
        "src/libbpf_common.h",
        "src/libbpf_legacy.h",
        "src/hashmap.h",
        ]),
    Library('libevent', [
        "event.c",
        "http.c",
        "test/regress.c",
        "buffer.c",
        "evdns.c",
        "test/regress_http.c",
        "evutil.c",
        "test/regress_dns.c",
        "bufferevent.c",
        "include/event2/http.h",
        "include/event2/event.h",
        "include/event.h",
        "kqueue.c",
        "signal.c",
        "event-internal.h",
        "test/regress_buffer.c",
        "epoll.c",
        "bufferevent_ssl.c",
        "bufferevent_mbedtls.c",
        "bufferevent_openssl.c",
        "include/event2/util.h",
        "test/regress_bufferevent.c",
        "epolltable-internal.h",
        "test/regress_main.c",
        "bufferevent-internal.h",
        "include/event2/buffer.h",
        "util-internal.h",
        "select.c",
        ]),
    Library('libexpat', [
        "expat/lib/xmlparse.c",
        "expat/lib/expat.h",
        "expat/lib/xmltok.c",
        "expat/xmlwf/xmlwf.c",
        "expat/lib/xmltok_impl.c",
        "expat/lib/xmlrole.c",
        "expat/lib/xmltok.h",
        "expat/xmlwf/xmlfile.c",
        "expat/examples/element_declarations.c",
        "expat/examples/elements.c",
        "expat/lib/internal.h",
        "expat/xmlwf/readfilemap.c",
        "expat/examples/outline.c",
        "expat/lib/xmlrole.h",
        "expat/xmlwf/codepage.c",
        "expat/lib/xmltok_ns.c",
        "expat/lib/expat_external.h",
        "expat/xmlwf/win32filemap.c",
        "expat/xmlwf/unixfilemap.c",
        "expat/xmlwf/xmlfile.h",
        "expat/lib/xmltok_impl.h",
        "expat/lib/iasciitab.h",
        "expat/lib/asciitab.h",
        "expat/xmlwf/filemap.h",
        "expat/lib/utf8tab.h",
        "expat/xmlwf/xmltchar.h",
        "expat/xmlwf/codepage.h",
        "expat/lib/winconfig.h",
        "expat/gennmtab/gennmtab.c",
        "expat/lib/latin1tab.h",
        "expat/lib/siphash.h",
        "expat/xmlwf/xmlmime.c",
    ]),
    Library('libgcrypt', [
        "cipher/pubkey.c",
        "cipher/cipher.c",
        "src/global.c",
        "cipher/md.c",
        "cipher/ecc.c",
        "src/g10lib.h",
        "random/random-csprng.c",
        "cipher/rsa.c",
        "random/random.c",
        "cipher/rijndael.c",
        "cipher/dsa.c",
        "src/cipher.h",
        "src/sexp.c",
        "mpi/mpiutil.c",
        "cipher/elgamal.c",
        "mpi/ec.c",
        "cipher/primegen.c",
        "random/rndgetentropy.c",
        "tests/benchmark.c",
        ]),
    Library('libjpeg-turbo', [
        "turbojpeg.c",
        "tjbench.c",
        "turbojpeg.h",
        "tjunittest.c",
        "cjpeg.c",
        "jchuff.c",
        "simd/jsimd.h",
        "turbojpeg-jni.c",
        "jdhuff.c",
        "jdcolor.c",
        "djpeg.c",
        "rdppm.c",
        "jpeglib.h",
        "jdmaster.c",
        "simd/i386/jsimd.c",
        "jmorecfg.h",
        "jdarith.c",
        "jccolor.c",
        "jidctint.c",
        "jcmaster.c",
        "jdapistd.c",
        "simd/x86_64/jsimd.c",
        "jdmerge.c",
        "rdbmp.c",
        "simd/arm/aarch64/jsimd.c",
        "jpegint.h",
        "jfdctint.c",
        "simd/arm/aarch32/jsimd.c",
        "jcphuff.c",
        "simd/powerpc/jsimd.c",
        "jcdctmgr.c",
        "jmemmgr.c",
        ]),
    Library('libjxl', [
        "lib/jxl/jxl_test.cc",
        "lib/jxl/entropy_coder.h",
        "lib/jxl/decode_test.cc",
        "lib/jxl/decode.cc",
        "lib/jxl/ans_params.h",
        "lib/jxl/encode.cc",
        "lib/jxl/enc_frame.cc",
        "lib/jxl/dec_frame.cc",
        "lib/jxl/enc_modular.cc",
        "lib/jxl/enc_adaptive_quantization.cc",
        "lib/jxl/encode_test.cc",
        "lib/jxl/jpeg/dec_jpeg_data.h",
        "lib/jxl/dec_modular.cc",
        "lib/jxl/base/arch_macros.h",
        "tools/cjxl_main.cc",
        "tools/benchmark/benchmark_xl.cc",
        "lib/jxl/dct_scales.cc",
        "lib/jxl/cms/jxl_cms.cc",
        "lib/extras/dec/apng.cc",
        "lib/jxl/test_utils.cc",
        ]),
    Library('libnsgif', [
        "src/gif.c",
        "src/lzw.c"
        ]),
    Library('libpng', [
        "png.c",
        "png.h"
        ]),
    Library('libsodium', [
        "src/libsodium/sodium/utils.c",
        "src/libsodium/crypto_core/ed25519/ref10/ed25519_ref10.c",
        "src/libsodium/crypto_aead/aes256gcm/aesni/aead_aes256gcm_aesni.c",
        "src/libsodium/crypto_aead/aes256gcm/armcrypto/aead_aes256gcm_armcrypto.c",
        "src/libsodium/randombytes/internal/randombytes_internal_random.c",
        "src/libsodium/randombytes/sysrandom/randombytes_sysrandom.c",
        "src/libsodium/sodium/core.c",
        "test/default/pwhash_argon2i.c",
        "src/libsodium/crypto_pwhash/argon2/argon2-core.c",
        "src/libsodium/include/sodium.h",
        "src/libsodium/sodium/runtime.c",
        "src/libsodium/randombytes/randombytes.c",
        "src/libsodium/crypto_sign/ed25519/ref10/open.c",
        "src/libsodium/include/sodium/private/common.h",
        "src/libsodium/crypto_core/ed25519/core_ed25519.c",
        "src/libsodium/include/sodium/private/ed25519_ref10.h",
        "src/libsodium/crypto_pwhash/scryptsalsa208sha256/sse/pwhash_scryptsalsa208sha256_sse.c",
        "src/libsodium/crypto_generichash/blake2b/ref/blake2b-ref.c",
        "src/libsodium/crypto_pwhash/scryptsalsa208sha256/nosse/pwhash_scryptsalsa208sha256_nosse.c",
        "src/libsodium/crypto_sign/ed25519/ref10/sign.c",
        "src/libsodium/include/sodium/utils.h",
        "src/libsodium/crypto_sign/ed25519/ref10/keypair.c",
        "src/libsodium/crypto_onetimeauth/poly1305/sse2/poly1305_sse2.c",
        "src/libsodium/include/sodium/crypto_sign_ed25519.h",
        "test/default/codecs.c",
        "src/libsodium/include/sodium/crypto_generichash_blake2b.h",
        "test/default/aead_aes256gcm.c",
        "test/default/sodium_utils2.c",
        "test/default/sodium_utils.c",
        "src/libsodium/crypto_pwhash/argon2/argon2.c",
        "src/libsodium/crypto_pwhash/scryptsalsa208sha256/crypto_scrypt-common.c",
        "src/libsodium/crypto_pwhash/scryptsalsa208sha256/pwhash_scryptsalsa208sha256.c",
        "src/libsodium/include/sodium/private/ed25519_ref10_fe_51.h",
        "src/libsodium/crypto_pwhash/argon2/argon2-fill-block-avx512f.c",
        "src/libsodium/crypto_pwhash/argon2/argon2-fill-block-avx2.c",
        "src/libsodium/crypto_pwhash/argon2/argon2-fill-block-ssse3.c",
        ]),
    Library('libsndfile', [
        "src/sndfile.c",
        "src/common.h",
        "src/wav.c",
        "src/aiff.c",
        "src/ogg_vorbis.c",
        "include/sndfile.h",
        "src/ogg.c",
        "src/common.c",
        "src/flac.c",
        "src/file_io.c",
        "src/wavlike.c",
        "src/caf.c",
        "programs/sndfile-play.c",
        "tests/command_test.c",
        "programs/sndfile-convert.c",
        "src/rf64.c",
        "src/alac.c",
        "src/sd2.c",
        "src/ima_adpcm.c",
        "tests/lossy_comp_test.c",
        "src/double64.c",
        "src/sfendian.h",
        "src/float32.c",
        "src/pcm.c",
        "programs/common.c",
        "src/w64.c",
        ]),
    Library('libtiff', [
       "libtiff/tif_dirread.c",
        "contrib/pds/tif_pdsdirread.c",
        "libtiff/tif_dir.c",
        "libtiff/tif_jpeg.c",
        "libtiff/tif_dirinfo.c",
        "tools/unsupported/tiff2pdf.c",
        "libtiff/tiffiop.h",
        "archive/tools/tiffcrop.c",
        "libtiff/tif_dirwrite.c",
        "libtiff/tif_getimage.c",
        "contrib/pds/tif_pdsdirwrite.c",
        "libtiff/tiffio.h",
        "tools/tiffcp.c",
        "libtiff/tif_fax3.c",
        "libtiff/tif_ojpeg.c",
        "libtiff/tif_read.c",
        "libtiff/tiff.h",
        "tools/unsupported/tiff2ps.c",
        "libtiff/tif_print.c",
        "libtiff/tif_lzw.c",
        "libtiff/tif_open.c",
        "libtiff/tif_dir.h",
        "libtiff/tif_pixarlog.c",
        "libtiff/tif_write.c",
        "libtiff/tif_luv.c",
        "libtiff/tif_zip.c",
        "libtiff/tif_win32.c",
        "libtiff/tif_predict.c",
        ]),
    Library('libusb', [
        "libusb/version_nano.h",
        "libusb/os/windows_winusb.c",
        "libusb/core.c",
        "libusb/io.c",
        "libusb/os/linux_usbfs.c",
        "libusb/os/darwin_usb.c",
        "libusb/libusbi.h",
        "libusb/libusb.h",
        "libusb/os/windows_winusb.h",
        "examples/xusb.c",
        "libusb/version.h",
        "libusb/descriptor.c",
        "libusb/os/windows_common.c",
        "libusb/os/windows_usbdk.c",
        "libusb/sync.c",
        "libusb/os/netbsd_usb.c",
        "libusb/os/openbsd_usb.c",
        "libusb/hotplug.c",
        "libusb/os/sunos_usb.c",
        "examples/dpfp.c",
        "libusb/os/windows_common.h",
        "libusb/os/events_posix.h",
        "libusb/os/threads_posix.c",
        ]),
    Library('libuv', [
        'src/uv-common.c',
        'src/uv-common.h',
        'src/unix/linux.c',
        'src/unix/core.c'
        ]),
    Library('libwebp', [
        "src/enc/vp8l_enc.c",
        "examples/cwebp.c",
        "src/dec/vp8l_dec.c",
        "src/dsp/dsp.h",
        "src/enc/backward_references_enc.c",
        "src/dsp/lossless_enc.c",
        "src/enc/vp8i_enc.h",
        "src/enc/picture_csp_enc.c",
        "src/dsp/lossless.c",
        "src/dec/vp8i_dec.h",
        "src/enc/histogram_enc.c",
        "src/dec/vp8_dec.c",
        "src/webp/encode.h",
        ]),
    Library('libyaml', [
        "src/scanner.c",
        "include/yaml.h",
        "src/api.c",
        "src/emitter.c",
        "src/yaml_private.h",
        "src/parser.c",
        "src/reader.c",
        "src/loader.c",
        "tests/run-emitter.c",
        "tests/run-dumper.c",
        "tests/example-deconstructor.c",
        "tests/test-reader.c",
        "src/writer.c",
        "tests/test-version.c",
        "tests/run-scanner.c",
        "src/dumper.c",
        ]),
    Library('libxml2', [
        "parser.c",
        "tree.c",
        "xpath.c",
        "HTMLparser.c",
        "xmlschemas.c",
        "valid.c",
        "xmllint.c",
        "xmlIO.c",
        "SAX2.c",
        "parserInternals.c",
        "xmlreader.c",
        "relaxng.c",
        "include/libxml/parser.h",
        "testapi.c",
        "include/libxml/tree.h",
        "xinclude.c",
        "encoding.c",
        "runtest.c",
        "xmlschemastypes.c",
        "xmlregexp.c",
        "debugXML.c",
        "SAX.c",
        "nanohttp.c",
        "HTMLtree.c",
        "entities.c",
        "error.c",
        "uri.c",
        ]),
    Library('libzmq', [
        "include/zmq.h",
        "src/socket_base.cpp",
        "src/zmq.cpp",
        "src/session_base.cpp",
        "src/options.cpp",
        "src/router.cpp",
        "src/ctx.cpp",
        "src/stream.cpp",
        "src/dgram.cpp",
        "src/socket_base.hpp",
        "src/ws_connecter.cpp",
        "src/tcp_connecter.cpp",
        "src/pipe.cpp",
        "src/ws_listener.cpp",
        "src/options.hpp",
        "src/tcp_listener.cpp",
        "src/signaler.cpp",
        "src/xpub.cpp",
        "src/tcp_address.cpp",
        "src/ip.cpp",
        "src/stream_engine_base.hpp",
        "src/ipc_listener.cpp",
        "src/session_base.hpp",
        "src/xsub.cpp",
        "src/tcp.cpp",
        "src/pipe.hpp",
        "src/ipc_connecter.cpp",
        "src/ctx.hpp",
        "src/zmq_draft.h",
        "src/dealer.cpp",
        "src/req.cpp",
        ]),
    Library('Little-CMS', [
        "src/cmstypes.c",
        "include/lcms2.h",
        "testbed/testcms2.c",
        "src/cmscgats.c",
        "src/cmsopt.c",
        "src/cmsio0.c",
        "src/cmsxform.c",
        "src/lcms2_internal.h",
        "src/cmslut.c",
        "src/cmspack.c",
        "src/cmsplugin.c",
        "src/cmscnvrt.c",
        "src/cmsps2.c",
        "src/cmsnamed.c",
        "src/cmsvirt.c",
        "src/cmsio1.c",
        "utils/tificc/tificc.c",
        "src/cmsgamma.c",
        "src/cmsintrp.c",
        ]),
    Library('lua', [
        "lvm.c",
        "lapi.c",
        "lgc.c",
        "ldo.c",
        "ltests.c",
        "lua.h",
        "lparser.c",
        "liolib.c",
        "lstate.c",
        "ldebug.c",
        "lbaselib.c",
        "lobject.h",
        "lstrlib.c",
        "lauxlib.c",
        "lcode.c",
        "luaconf.h",
        "lstate.h",
        "ltable.c",
        "llex.c",
        "lua.c",
        "lobject.c",
        ]),
    Library('mbedtls', [
        "library/ssl_tls.c",
        "library/ssl_msg.c",
        "include/mbedtls/ssl.h",
        "include/mbedtls/mbedtls_config.h",
        "library/ssl_tls12_server.c",
        "library/ssl_tls12_client.c",
        "library/x509_crt.c",
        "programs/ssl/ssl_server2.c",
        "library/psa_crypto.c",
        "programs/ssl/ssl_client2.c",
        "library/bignum.c",
        "library/ecp.c",
        "library/rsa.c",
        "library/ssl_misc.h",
        "library/aes.c",
        "include/mbedtls/check_config.h",
        "include/mbedtls/x509_crt.h",
        "include/mbedtls/pk.h",
        "library/cipher.c",
        "include/mbedtls/config_adjust_legacy_from_psa.h",
        "include/mbedtls/config_psa.h",
        "include/mbedtls/rsa.h",
        "library/pk_wrap.c",
        "library/ssl_tls13_client.c",
        "include/psa/crypto.h",
        "include/mbedtls/x509.h",
        "include/mbedtls/ecp.h",
        "library/ssl_tls13_server.c",
        "library/pk.c",
        "include/mbedtls/bignum.h",
        "include/mbedtls/cipher.h",
        "library/x509.c",
        "include/mbedtls/error.h",
        "library/net_sockets.c",
        "library/ecdsa.c",
        "library/sha256.c",
        "library/pkparse.c",
        "include/mbedtls/version.h",
        "library/sha512.c",
        ]),
    Library('minizip-ng', [
        "minizip.c",
        "mz_zip.c"
        ]),
    Library('nghttp2', [
        "lib/nghttp2_session.c",
        "src/shrpx.cc",
        "lib/includes/nghttp2/nghttp2.h",
        "src/shrpx_http2_upstream.cc",
        "src/shrpx_config.cc",
        "src/shrpx_http2_session.cc",
        "src/nghttp.cc",
        "src/h2load_quic.cc",
        "src/shrpx_config.h",
        "tests/nghttp2_session_test.c",
        "src/h2load.cc",
        "src/shrpx_tls.cc",
        "src/shrpx_https_upstream.cc",
        "src/HttpServer.cc",
        "src/shrpx_client_handler.cc",
        "src/shrpx_http_downstream_connection.cc",
        "src/shrpx_http3_upstream.cc",
        "src/shrpx_downstream.cc",
        "tests/main.c",
        "lib/nghttp2_hd.c",
        "src/util.cc",
        "src/util.h",
        "src/shrpx_http2_downstream_connection.cc",
        "lib/nghttp2_session.h",
        "src/shrpx_worker.cc",
        "lib/nghttp2_frame.c",
        "src/shrpx_downstream.h",
        "src/shrpx_connection_handler.cc",
        "src/http2.cc",
        ]),
    Library('ocf', [
        "src/mngt/ocf_mngt_cache.c",
        "src/metadata/metadata.c",
        "src/engine/engine_common.c",
        "src/mngt/ocf_mngt_flush.c",
        "src/ocf_core.c",
        "src/mngt/ocf_mngt_core.c",
        "src/ocf_request.h",
        "src/metadata/metadata_io.c",
        "src/utils/utils_cleaner.c",
        "src/utils/utils_alock.c",
        "inc/ocf_mngt.h",
        "src/concurrency/ocf_cache_line_concurrency.c",
        "src/ocf_lru.c",
        "src/ocf_cache_priv.h",
        "src/ocf_cache.c",
        "src/engine/engine_discard.c",
        "src/mngt/ocf_mngt_common.c",
        "src/cleaning/acp.c",
        "src/metadata/metadata_raw_dynamic.c",
        "src/metadata/metadata_superblock.c",
        "src/engine/engine_rd.c",
        "src/cleaning/alru.c",
        "src/engine/engine_pt.c",
        "src/metadata/metadata_raw.c",
        "env/posix/ocf_env.h",
        "src/engine/engine_wb.c",
        "src/engine/engine_wi.c",
        "src/metadata/metadata_structs.h",
        "src/engine/engine_wt.c",
        "src/concurrency/ocf_cache_line_concurrency.h",
        ]),
    Library('openjpeg', [
        "src/lib/openjp2/j2k.c",
        "src/lib/openjp2/tcd.c",
        "src/bin/jp2/opj_compress.c",
        "src/lib/openjp2/jp2.c",
        "src/lib/openjp2/openjpeg.h",
        "src/bin/jp2/convert.c",
        "src/lib/openjp2/t1.c",
        "src/bin/jp2/opj_decompress.c",
        "src/lib/openjp2/t2.c",
        "src/lib/openjp2/openjpeg.c",
        "src/bin/jp2/opj_dump.c",
        "src/lib/openjp2/dwt.c",
        "src/lib/openjp2/j2k.h",
        "wrapping/java/openjp2/JavaOpenJPEG.c",
        "src/lib/openjp2/pi.c",
        "src/lib/openjp2/tcd.h",
        "src/lib/openjp2/jp2.h",
        "src/lib/openjp2/opj_includes.h",
        "wrapping/java/openjp2/JavaOpenJPEGDecoder.c",
        ]),
    Library('pcre2', [
        "src/*",
        ]),
    Library('sqlite', [
        "src/sqliteInt.h",
        "src/vdbe.c",
        "src/where.c",
        "src/btree.c",
        "src/select.c",
        "src/expr.c",
        "src/build.c",
        "src/pager.c",
        "src/main.c",
        "src/vdbeaux.c",
        "src/os_unix.c",
        "src/insert.c",
        "src/test1.c",
        "src/pragma.c",
        "src/util.c",
        "src/func.c",
        "src/os_win.c",
        "src/update.c",
        "src/vdbeInt.h",
        "src/delete.c",
        "src/tclsqlite.c",
        "src/vdbeapi.c",
        "src/wal.c",
        ]),
    Library('tinyxml2', [
        "tinyxml2.h",
        "tinyxml2.cpp"
        ]),
    Library('uthash', [
        "src/uthash.h",
        "src/utlist.h",
        "src/utarray.h",
        "src/utstring.h",
        "src/utringbuffer.h"
        ]),
    Library('uvwasi', [
        "src/*",
        ]),
    Library('wolfssl', [
        "src/ssl.c",
        "src/internal.c",
        "tests/api.c",
        "wolfcrypt/src/asn.c",
        "wolfcrypt/test/test.c",
        "wolfssl/internal.h",
        "wolfssl/ssl.h",
        "wolfcrypt/src/ecc.c",
        "src/tls.c",
        "examples/client/client.c",
        "wolfssl/wolfcrypt/settings.h",
        "wolfssl/wolfcrypt/asn.h",
        "wolfssl/test.h",
        "examples/server/server.c",
        "wolfssl/wolfcrypt/types.h",
        "src/tls13.c",
        "wolfcrypt/src/aes.c",
        "wolfssl/openssl/ssl.h",
        "wolfcrypt/src/pkcs7.c",
        ]),
    Library('xxHash', [
        "xxhash.h",
        "xxh3.h",
        "xxhash.c"
        ]),
    Library('xz', [
        "src/liblzma/api/lzma/block.h",
        "src/liblzma/common/stream_decoder.c",
        "src/liblzma/common/stream_encoder.c",
        "src/liblzma/common/block_decoder.c",
        "src/liblzma/common/block_encoder.c",
        "src/liblzma/lz/lz_decoder.c",
        "src/liblzma/lz/lz_encoder.c",
        "src/liblzma/lzma/lzma_decoder.c",
        "src/liblzma/lzma/lzma_encoder.c",
        "src/liblzma/rangecoder/range_decoder.h",
        "src/xz/coder.c"
        ]),
    Library('xz-embedded', [
        "linux/lib/decompress_unxz.c",
        "linux/lib/xz/xz_dec_stream.c",
        "linux/lib/xz/xz_dec_lzma2.c",
        "linux/lib/xz/xz_private.h",
        "linux/lib/xz/xz_dec_bcj.c",
        "linux/include/linux/xz.h",
        "userspace/xz_config.h",
        "userspace/xzminidec.c",
        "linux/lib/xz/xz_stream.h",
        "linux/lib/xz/xz_crc64.c",
        "linux/include/linux/decompress/unxz.h",
        "linux/lib/xz/xz_dec_syms.c",
        "linux/lib/xz/xz_dec_test.c",
        "linux/lib/xz/xz_crc32.c",
        "userspace/buftest.c",
        "linux/lib/xz/xz_lzma2.h",
        ]),
    Library('zlib', [
        "*"
        ]),
    Library('zstd', [
        "lib/zstd.h",
        "lib/common/fse.h",
        "lib/common/zstd_internal.h",
        "lib/compress/zstd_compress.c",
        "lib/decompress/zstd_decompress.c",
        ]),
]

# Some libraries embed code themselves:
embedded = {
    "aom":        ["googletest"],
    "boringssl":  ["googletest"],
    # botan embeds numerous test files from these:
    "botan":      ["boringssl", "mbedtls"],
    "fmt":        ["googletest"],
    "freetype":   ["zlib"],
    "libjxl":     ["brotli", "googletest", "Little-CMS", "libjpeg-turbo", "libpng"],
    "libpng":     ["zlib"],
    "libsndfile": ["flac"],
    "minizip-ng": ["xz"],
    "openjpeg":   ["libpng", "libtiff", "Little-CMS", "zlib"],
    #"protobuf":   ["googletest"],
    "zlib":       ["minizip-ng"],
    "zstd":       ["xxHash", "zlib"],
}

# vim:set expandtab tabstop=4 shiftwidth=4 softtabstop=4 nowrap:
